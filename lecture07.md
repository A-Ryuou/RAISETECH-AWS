# 第7回課題提出

<br>
<br>

## ○自分で構築したAWS環境の中で脆弱性が認められる箇所とその対策について考察

<br>

第6回講義までで構築した環境の中で、脆弱性がある（かも）と思ったのは下記の3点。

<br>

1. ALBのリスナーにHTTPしか設定しておらず、HTTPS（SSL）通信ができていない
2. EC2のセキュリティグループのインバウンドルールにおいて不要なポートも空けている

<br>

### **①ALBのリスナーにHTTPしか設定しておらず、HTTPS（SSL）通信ができていない**

<br>
＜現状＞
<br>
HTTP通信のみ設定しているので、外部との通信がセキュアになっていない。

<br>
＜対策＞
<br>
第7回講義でも取り上げられていたが、Route 53などでドメインを取得し、ACMでSSL証明書を発行後ALBにSSL証明書をアタッチする。そしてALBにHTTPSリスナーを追加し、ALBにアタッチされているセキュリティグループのインバウンドルールにHTTPSを追加すればインターネット→ALB間でHTTPS通信が可能となる。

<br>
<br>

### **②EC2のセキュリティグループのインバウンドルールにおいて不要なポートも空けている**

<br>
＜現状＞
<br>
インバウンドルールを下図のように設定している。ALBを噛ませているので、ALB→EC2のHTTP通信だけ許可すれば問題ないはずだが、HTTP（ポート番号80）とHTTPS（ポート番号443）、さらにPumaとUnicorn用に空けたポート番号3000と8080に関してあらゆるIPアドレスからの接続を許可してしまっている。

<br>

![](images/07/inbound.png)

<br>

＜対策＞
<br>
インバウンドルールを編集し、必要最低限のポートだけ開けるようにした（下図参照）。
<br>
Puma用のポート番号3000は一応空けたままにしておいた。
<br>
この設定でも問題なくサンプルアプリにアクセスできた。

<br>

![](images/07/fixed_inbound.png)

<br>
<br>


## 感想

<br>

* セキュリティに関するAWSサービスは多種多様なので、クライアントのニーズに合わせて使い分け・提案できるようになった方がよいと思った。

* わからないワードなどを調べながら講義の内容を復習したい。まずはセキュリティの根本的な考え方から。

<br>